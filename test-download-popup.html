<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Popup Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
        }
        .test-button {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
        }
        .test-button:hover {
            background-color: #2563eb;
        }
    </style>
</head>
<body>
    <h1>Download Popup Test</h1>
    <p>This page tests the download popup functionality. Click the buttons below to simulate different download scenarios.</p>
    
    <button class="test-button" onclick="testDownloadStart()">Start Download</button>
    <button class="test-button" onclick="testDownloadProgress()">Simulate Progress</button>
    <button class="test-button" onclick="testDownloadComplete()">Complete Download</button>
    <button class="test-button" onclick="testDownloadError()">Simulate Error</button>
    <button class="test-button" onclick="testClosePopup()">Close Popup</button>

    <script>
        // Mock the global functions that would be provided by the header component
        let mockProgress = {
            percentage: 0,
            bytesDownloaded: 0,
            bytesTotal: 1024 * 1024 * 10, // 10MB
            bytesPerSecond: 0,
            status: 'downloading'
        };

        function testDownloadStart() {
            if (window.showDownloadPopup) {
                window.showDownloadPopup('Test File.mp3', '10MB');
            } else {
                alert('showDownloadPopup function not available');
            }
        }

        function testDownloadProgress() {
            if (window.updateDownloadProgress) {
                mockProgress.percentage = Math.min(mockProgress.percentage + 20, 100);
                mockProgress.bytesDownloaded = (mockProgress.percentage / 100) * mockProgress.bytesTotal;
                mockProgress.bytesPerSecond = 500 * 1024; // 500KB/s
                
                if (mockProgress.percentage >= 100) {
                    mockProgress.status = 'completed';
                }
                
                window.updateDownloadProgress(mockProgress);
            } else {
                alert('updateDownloadProgress function not available');
            }
        }

        function testDownloadComplete() {
            if (window.updateDownloadProgress) {
                mockProgress.percentage = 100;
                mockProgress.bytesDownloaded = mockProgress.bytesTotal;
                mockProgress.status = 'completed';
                window.updateDownloadProgress(mockProgress);
            } else {
                alert('updateDownloadProgress function not available');
            }
        }

        function testDownloadError() {
            if (window.setDownloadError) {
                window.setDownloadError('Network connection lost. Please try again.');
            } else {
                alert('setDownloadError function not available');
            }
        }

        function testClosePopup() {
            // This would be handled by the popup component itself
            alert('Popup should close automatically when download completes or fails');
        }

        // Check if functions are available
        window.addEventListener('load', function() {
            console.log('Available functions:', {
                showDownloadPopup: typeof window.showDownloadPopup,
                updateDownloadProgress: typeof window.updateDownloadProgress,
                setDownloadError: typeof window.setDownloadError
            });
        });
    </script>
</body>
</html>
